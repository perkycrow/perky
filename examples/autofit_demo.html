<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas2D AutoFit Demo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .demo-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.6);
        }

        button:active {
            transform: translateY(0);
        }

        .canvas-container {
            border: 3px solid #667eea;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
            background: #f8f9fa;
            position: relative;
        }

        .info {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 14px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            color: #666;
            font-size: 12px;
            margin-bottom: 4px;
        }

        .info-value {
            color: #333;
            font-weight: 600;
            font-size: 16px;
        }

        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            overflow-x: auto;
        }

        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Canvas2D AutoFit Demo</h1>

        <div class="demo-card">
            <h2>Redimensionne le container et regarde le canvas s'adapter !</h2>
            
            <div class="controls">
                <button onclick="setSize(400, 300)">üì± Small (400x300)</button>
                <button onclick="setSize(600, 400)">üíª Medium (600x400)</button>
                <button onclick="setSize(800, 500)">üñ•Ô∏è Large (800x500)</button>
                <button onclick="setSize(1000, 600)">üì∫ XLarge (1000x600)</button>
                <button onclick="toggleAnimation()">‚ñ∂Ô∏è Toggle Animation</button>
            </div>

            <div id="canvasContainer" class="canvas-container" style="width: 600px; height: 400px;">
                <!-- Canvas sera cr√©√© ici automatiquement -->
            </div>

            <div class="info">
                <div class="info-item">
                    <span class="info-label">Container Size</span>
                    <span class="info-value" id="containerSize">600 x 400</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Canvas Display Size</span>
                    <span class="info-value" id="canvasSize">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Pixel Ratio</span>
                    <span class="info-value" id="pixelRatio">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Actual Canvas Size</span>
                    <span class="info-value" id="actualSize">-</span>
                </div>
            </div>

            <div class="code-example">
<span class="keyword">import</span> Canvas2D <span class="keyword">from</span> <span class="string">'./canvas/canvas_2d'</span>

<span class="comment">// Le canvas s'adapte automatiquement au container !</span>
<span class="keyword">const</span> renderer = <span class="keyword">new</span> Canvas2D({
  container: <span class="keyword">document</span>.getElementById(<span class="string">'canvasContainer'</span>),
  autoFit: <span class="keyword">true</span>,  <span class="comment">// üéØ La magie se passe ici !</span>
  pixelRatio: <span class="keyword">window</span>.devicePixelRatio
})

<span class="comment">// Plus besoin de g√©rer le resize manuellement ‚ú®</span>
            </div>
        </div>
    </div>

    <script type="module">
        import Canvas2D from '../canvas/canvas_2d.js'
        import Group2D from '../canvas/group_2d.js'
        import Circle from '../canvas/circle.js'
        import Rectangle from '../canvas/rectangle.js'

        const container = document.getElementById('canvasContainer')
        
        // Cr√©er le renderer avec autoFit
        const renderer = new Canvas2D({
            container,
            autoFit: true,  // üéØ Le canvas s'adapte automatiquement !
            pixelRatio: window.devicePixelRatio || 1,
            backgroundColor: '#f0f0f0'
        })

        // Cr√©er la sc√®ne
        const scene = new Group2D()
        
        // Ajouter des formes anim√©es
        const shapes = []
        for (let i = 0; i < 20; i++) {
            const isCircle = Math.random() > 0.5
            const shape = isCircle
                ? new Circle({
                    x: (Math.random() - 0.5) * 5,
                    y: (Math.random() - 0.5) * 5,
                    radius: 0.2 + Math.random() * 0.3,
                    color: `hsl(${Math.random() * 360}, 70%, 60%)`,
                    strokeWidth: 0
                })
                : new Rectangle({
                    x: (Math.random() - 0.5) * 5,
                    y: (Math.random() - 0.5) * 5,
                    width: 0.3 + Math.random() * 0.4,
                    height: 0.3 + Math.random() * 0.4,
                    rotation: Math.random() * Math.PI * 2,
                    color: `hsl(${Math.random() * 360}, 70%, 60%)`,
                    strokeWidth: 0
                })
            
            shape.velocity = {
                x: (Math.random() - 0.5) * 2,
                y: (Math.random() - 0.5) * 2,
                rotation: (Math.random() - 0.5) * 0.1
            }
            
            shapes.push(shape)
            scene.addChild(shape)
        }

        // Animation
        let isAnimating = true
        function animate () {
            if (isAnimating) {
                shapes.forEach(shape => {
                    shape.x += shape.velocity.x * 0.016
                    shape.y += shape.velocity.y * 0.016
                    shape.rotation += shape.velocity.rotation

                    // Rebondir sur les bords
                    const bounds = 3
                    if (Math.abs(shape.x) > bounds) {
                        shape.velocity.x *= -1
                        shape.x = Math.sign(shape.x) * bounds
                    }
                    if (Math.abs(shape.y) > bounds) {
                        shape.velocity.y *= -1
                        shape.y = Math.sign(shape.y) * bounds
                    }
                })
            }

            renderer.render(scene)
            updateInfo()
            requestAnimationFrame(animate)
        }

        animate()

        // Fonctions de contr√¥le
        window.setSize = function (width, height) {
            container.style.width = width + 'px'
            container.style.height = height + 'px'
            // Le canvas se redimensionne tout seul gr√¢ce √† autoFit ! ‚ú®
        }

        window.toggleAnimation = function () {
            isAnimating = !isAnimating
        }

        function updateInfo () {
            document.getElementById('containerSize').textContent = 
                `${container.clientWidth} x ${container.clientHeight}`
            document.getElementById('canvasSize').textContent = 
                `${renderer.displayWidth} x ${renderer.displayHeight}`
            document.getElementById('pixelRatio').textContent = 
                `${renderer.pixelRatio}x`
            document.getElementById('actualSize').textContent = 
                `${renderer.canvas.width} x ${renderer.canvas.height}`
        }

        updateInfo()
    </script>
</body>
</html>
